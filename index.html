<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>E-Commerce Management System</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 30px;
    }
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #ddd;
    }
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      background: #f0f0f0;
      border: none;
      border-radius: 4px 4px 0 0;
      font-size: 14px;
      font-weight: 500;
    }
    .tab.active {
      background: #4CAF50;
      color: white;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .section {
      border: 1px solid #ddd;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
      background: #fafafa;
    }
    .section h3 {
      margin-top: 0;
      color: #555;
      border-bottom: 1px solid #ddd;
      padding-bottom: 10px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }
    input, textarea, select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    button {
      padding: 10px 20px;
      margin: 5px 5px 5px 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: background 0.3s;
    }
    .btn-primary {
      background: #4CAF50;
      color: white;
    }
    .btn-primary:hover {
      background: #45a049;
    }
    .btn-secondary {
      background: #2196F3;
      color: white;
    }
    .btn-secondary:hover {
      background: #0b7dda;
    }
    .btn-danger {
      background: #f44336;
      color: white;
    }
    .btn-danger:hover {
      background: #da190b;
    }
    .btn-warning {
      background: #ff9800;
      color: white;
    }
    .btn-warning:hover {
      background: #e68900;
    }
    .result {
      background: #f7f7f7;
      padding: 15px;
      border-radius: 4px;
      max-height: 400px;
      overflow: auto;
      margin-top: 20px;
      border: 1px solid #ddd;
    }
    pre {
      margin: 0;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    .data-table th,
    .data-table td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    .data-table th {
      background: #4CAF50;
      color: white;
    }
    .data-table tr:hover {
      background: #f5f5f5;
    }
    .action-buttons {
      display: flex;
      gap: 5px;
    }
    .action-buttons button {
      padding: 5px 10px;
      font-size: 12px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸ›’ E-Commerce Management System</h1>
    
    <div class="tabs">
      <button class="tab active" onclick="showTab('customers')">Customers</button>
      <button class="tab" onclick="showTab('employees')">Employees</button>
      <button class="tab" onclick="showTab('products')">Products</button>
      <button class="tab" onclick="showTab('orders')">Orders</button>
    </div>

    <!-- Customers Tab -->
    <div id="customers" class="tab-content active">
      <div class="grid">
        <div class="section">
          <h3>Create/Update Customer</h3>
          <div class="form-group">
            <label>ID (leave empty for new)</label>
            <input type="number" id="cust_id" placeholder="Leave empty for new customer">
          </div>
          <div class="form-group">
            <label>Name *</label>
            <input type="text" id="cust_name" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" id="cust_email" required>
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="text" id="cust_phone">
          </div>
          <div class="form-group">
            <label>Address</label>
            <textarea id="cust_address"></textarea>
          </div>
          <button class="btn-primary" onclick="createOrUpdateCustomer()">Save Customer</button>
          <button class="btn-secondary" onclick="loadCustomerForEdit()">Load by ID</button>
        </div>
        <div class="section">
          <h3>Customer Operations</h3>
          <button class="btn-secondary" onclick="listCustomers()">List All Customers</button>
          <button class="btn-secondary" onclick="viewCustomer()">View Customer by ID</button>
          <button class="btn-danger" onclick="deleteCustomer()">Delete Customer by ID</button>
          <div class="form-group" style="margin-top: 15px;">
            <label>Customer ID</label>
            <input type="number" id="cust_view_id" placeholder="Enter ID">
          </div>
        </div>
      </div>
    </div>

    <!-- Employees Tab -->
    <div id="employees" class="tab-content">
      <div class="grid">
        <div class="section">
          <h3>Create/Update Employee</h3>
          <div class="form-group">
            <label>ID (leave empty for new)</label>
            <input type="number" id="emp_id" placeholder="Leave empty for new employee">
          </div>
          <div class="form-group">
            <label>Name *</label>
            <input type="text" id="emp_name" required>
          </div>
          <div class="form-group">
            <label>Role *</label>
            <input type="text" id="emp_role" placeholder="e.g., Manager, Sales, Admin" required>
          </div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" id="emp_email">
          </div>
          <button class="btn-primary" onclick="createOrUpdateEmployee()">Save Employee</button>
          <button class="btn-secondary" onclick="loadEmployeeForEdit()">Load by ID</button>
        </div>
        <div class="section">
          <h3>Employee Operations</h3>
          <button class="btn-secondary" onclick="listEmployees()">List All Employees</button>
          <button class="btn-secondary" onclick="viewEmployee()">View Employee by ID</button>
          <button class="btn-danger" onclick="deleteEmployee()">Delete Employee by ID</button>
          <div class="form-group" style="margin-top: 15px;">
            <label>Employee ID</label>
            <input type="number" id="emp_view_id" placeholder="Enter ID">
          </div>
        </div>
      </div>
    </div>

    <!-- Products Tab -->
    <div id="products" class="tab-content">
      <div class="grid">
        <div class="section">
          <h3>Create/Update Product</h3>
          <div class="form-group">
            <label>ID (leave empty for new)</label>
            <input type="number" id="prod_id" placeholder="Leave empty for new product">
          </div>
          <div class="form-group">
            <label>Name *</label>
            <input type="text" id="prod_name" required>
          </div>
          <div class="form-group">
            <label>Description</label>
            <textarea id="prod_desc"></textarea>
          </div>
          <div class="form-group">
            <label>Price *</label>
            <input type="number" id="prod_price" step="0.01" min="0" required>
          </div>
          <div class="form-group">
            <label>Stock</label>
            <input type="number" id="prod_stock" min="0" value="0">
          </div>
          <button class="btn-primary" onclick="createOrUpdateProduct()">Save Product</button>
          <button class="btn-secondary" onclick="loadProductForEdit()">Load by ID</button>
        </div>
        <div class="section">
          <h3>Product Operations</h3>
          <button class="btn-secondary" onclick="listProducts()">List All Products</button>
          <button class="btn-secondary" onclick="viewProduct()">View Product by ID</button>
          <button class="btn-danger" onclick="deleteProduct()">Delete Product by ID</button>
          <div class="form-group" style="margin-top: 15px;">
            <label>Product ID</label>
            <input type="number" id="prod_view_id" placeholder="Enter ID">
          </div>
        </div>
      </div>
    </div>

    <!-- Orders Tab -->
    <div id="orders" class="tab-content">
      <div class="grid">
        <div class="section">
          <h3>Create Order</h3>
          <div class="form-group">
            <label>Customer ID *</label>
            <input type="number" id="order_customer_id" required>
          </div>
          <div class="form-group">
            <label>Order Items (JSON) *</label>
            <textarea id="order_items" placeholder='[{"product_id": 1, "quantity": 2}, {"product_id": 2, "quantity": 1}]' required></textarea>
            <small style="color: #666;">Format: [{"product_id": 1, "quantity": 2}]</small>
          </div>
          <button class="btn-primary" onclick="createOrder()">Place Order</button>
        </div>
        <div class="section">
          <h3>Order Operations</h3>
          <button class="btn-secondary" onclick="listOrders()">List All Orders</button>
          <button class="btn-secondary" onclick="viewOrder()">View Order Details by ID</button>
          <div class="form-group" style="margin-top: 15px;">
            <label>Order ID</label>
            <input type="number" id="order_view_id" placeholder="Enter ID">
          </div>
        </div>
      </div>
    </div>

    <!-- Results Section -->
    <div class="result">
      <h3>API Response</h3>
      <pre id="result">No operations performed yet. Use the buttons above to interact with the API.</pre>
    </div>
  </div>

  <script>
    const apiBase = '/api';

    function showTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    }

    function showResult(data) {
      document.getElementById('result').textContent = JSON.stringify(data, null, 2);
    }

    function showError(error) {
      showResult({ error: error.message || error });
    }

    // Customer Functions
    async function createOrUpdateCustomer() {
      const id = document.getElementById('cust_id').value;
      const body = {
        name: document.getElementById('cust_name').value,
        email: document.getElementById('cust_email').value,
        phone: document.getElementById('cust_phone').value,
        address: document.getElementById('cust_address').value
      };
      if (!body.name || !body.email) {
        alert('Name and email are required');
        return;
      }
      try {
        const url = id ? `${apiBase}/customers/${id}` : `${apiBase}/customers`;
        const method = id ? 'PUT' : 'POST';
        const res = await fetch(url, {
          method,
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        showResult(data);
        if (res.ok) {
          document.getElementById('cust_id').value = '';
          document.getElementById('cust_name').value = '';
          document.getElementById('cust_email').value = '';
          document.getElementById('cust_phone').value = '';
          document.getElementById('cust_address').value = '';
        }
      } catch (e) {
        showError(e);
      }
    }

    async function loadCustomerForEdit() {
      const id = document.getElementById('cust_view_id').value;
      if (!id) {
        alert('Please enter a customer ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/customers/${id}`);
        const data = await res.json();
        if (data.error) {
          showResult(data);
        } else {
          document.getElementById('cust_id').value = data.id;
          document.getElementById('cust_name').value = data.name || '';
          document.getElementById('cust_email').value = data.email || '';
          document.getElementById('cust_phone').value = data.phone || '';
          document.getElementById('cust_address').value = data.address || '';
          showResult(data);
        }
      } catch (e) {
        showError(e);
      }
    }

    async function listCustomers() {
      try {
        const res = await fetch(`${apiBase}/customers`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function viewCustomer() {
      const id = document.getElementById('cust_view_id').value;
      if (!id) {
        alert('Please enter a customer ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/customers/${id}`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function deleteCustomer() {
      const id = document.getElementById('cust_view_id').value;
      if (!id) {
        alert('Please enter a customer ID');
        return;
      }
      if (!confirm('Are you sure you want to delete this customer?')) return;
      try {
        const res = await fetch(`${apiBase}/customers/${id}`, { method: 'DELETE' });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    // Employee Functions
    async function createOrUpdateEmployee() {
      const id = document.getElementById('emp_id').value;
      const body = {
        name: document.getElementById('emp_name').value,
        role: document.getElementById('emp_role').value,
        email: document.getElementById('emp_email').value
      };
      if (!body.name || !body.role) {
        alert('Name and role are required');
        return;
      }
      try {
        const url = id ? `${apiBase}/employees/${id}` : `${apiBase}/employees`;
        const method = id ? 'PUT' : 'POST';
        const res = await fetch(url, {
          method,
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        showResult(data);
        if (res.ok) {
          document.getElementById('emp_id').value = '';
          document.getElementById('emp_name').value = '';
          document.getElementById('emp_role').value = '';
          document.getElementById('emp_email').value = '';
        }
      } catch (e) {
        showError(e);
      }
    }

    async function loadEmployeeForEdit() {
      const id = document.getElementById('emp_view_id').value;
      if (!id) {
        alert('Please enter an employee ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/employees/${id}`);
        const data = await res.json();
        if (data.error) {
          showResult(data);
        } else {
          document.getElementById('emp_id').value = data.id;
          document.getElementById('emp_name').value = data.name || '';
          document.getElementById('emp_role').value = data.role || '';
          document.getElementById('emp_email').value = data.email || '';
          showResult(data);
        }
      } catch (e) {
        showError(e);
      }
    }

    async function listEmployees() {
      try {
        const res = await fetch(`${apiBase}/employees`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function viewEmployee() {
      const id = document.getElementById('emp_view_id').value;
      if (!id) {
        alert('Please enter an employee ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/employees/${id}`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function deleteEmployee() {
      const id = document.getElementById('emp_view_id').value;
      if (!id) {
        alert('Please enter an employee ID');
        return;
      }
      if (!confirm('Are you sure you want to delete this employee?')) return;
      try {
        const res = await fetch(`${apiBase}/employees/${id}`, { method: 'DELETE' });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    // Product Functions
    async function createOrUpdateProduct() {
      const id = document.getElementById('prod_id').value;
      const body = {
        name: document.getElementById('prod_name').value,
        description: document.getElementById('prod_desc').value,
        price: parseFloat(document.getElementById('prod_price').value),
        stock: parseInt(document.getElementById('prod_stock').value || '0', 10)
      };
      if (!body.name || body.price == null) {
        alert('Name and price are required');
        return;
      }
      try {
        const url = id ? `${apiBase}/products/${id}` : `${apiBase}/products`;
        const method = id ? 'PUT' : 'POST';
        const res = await fetch(url, {
          method,
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        showResult(data);
        if (res.ok) {
          document.getElementById('prod_id').value = '';
          document.getElementById('prod_name').value = '';
          document.getElementById('prod_desc').value = '';
          document.getElementById('prod_price').value = '';
          document.getElementById('prod_stock').value = '0';
        }
      } catch (e) {
        showError(e);
      }
    }

    async function loadProductForEdit() {
      const id = document.getElementById('prod_view_id').value;
      if (!id) {
        alert('Please enter a product ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/products/${id}`);
        const data = await res.json();
        if (data.error) {
          showResult(data);
        } else {
          document.getElementById('prod_id').value = data.id;
          document.getElementById('prod_name').value = data.name || '';
          document.getElementById('prod_desc').value = data.description || '';
          document.getElementById('prod_price').value = data.price || '';
          document.getElementById('prod_stock').value = data.stock || '0';
          showResult(data);
        }
      } catch (e) {
        showError(e);
      }
    }

    async function listProducts() {
      try {
        const res = await fetch(`${apiBase}/products`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function viewProduct() {
      const id = document.getElementById('prod_view_id').value;
      if (!id) {
        alert('Please enter a product ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/products/${id}`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function deleteProduct() {
      const id = document.getElementById('prod_view_id').value;
      if (!id) {
        alert('Please enter a product ID');
        return;
      }
      if (!confirm('Are you sure you want to delete this product?')) return;
      try {
        const res = await fetch(`${apiBase}/products/${id}`, { method: 'DELETE' });
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    // Order Functions
    async function createOrder() {
      let items;
      try {
        items = JSON.parse(document.getElementById('order_items').value);
      } catch (e) {
        alert('Invalid JSON for items. Format: [{"product_id": 1, "quantity": 2}]');
        return;
      }
      const body = {
        customer_id: parseInt(document.getElementById('order_customer_id').value, 10),
        items
      };
      if (!body.customer_id || !items || items.length === 0) {
        alert('Customer ID and items are required');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/orders`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body)
        });
        const data = await res.json();
        showResult(data);
        if (res.ok) {
          document.getElementById('order_customer_id').value = '';
          document.getElementById('order_items').value = '';
        }
      } catch (e) {
        showError(e);
      }
    }

    async function listOrders() {
      try {
        const res = await fetch(`${apiBase}/orders`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }

    async function viewOrder() {
      const id = document.getElementById('order_view_id').value;
      if (!id) {
        alert('Please enter an order ID');
        return;
      }
      try {
        const res = await fetch(`${apiBase}/orders/${id}`);
        const data = await res.json();
        showResult(data);
      } catch (e) {
        showError(e);
      }
    }
  </script>
</body>
</html>